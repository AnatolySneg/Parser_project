import pytest
from src.currency_parse.schemas import Banks, CurrencyOption
from src.logic.currency_logic import CurrencyTransformation
from src.exceptions.currency_logic_exceptions import ValidationDataError
from src.config import NATIONAL_BANK, PRIVAT_BANK, MONO_BANK
from datetime import datetime


class TestLogicValidData:
    def get_data_source(self):
        privat = [{"ccy": "EUR", "base_ccy": "UAH", "buy": "41.15000", "sale": "42.19409"},
                  {"ccy": "USD", "base_ccy": "UAH", "buy": "37.65000", "sale": "38.46154"}]
        mono = [{"currencyCodeA": 840, "currencyCodeB": 980, "date": 1704383173, "rateBuy": 38, "rateSell": 38.4497},
                {"currencyCodeA": 978, "currencyCodeB": 980, "date": 1704383173, "rateBuy": 41.5, "rateSell": 42.1496},
                {"currencyCodeA": 978, "currencyCodeB": 840, "date": 1704383173, "rateBuy": 1.088, "rateSell": 1.1},
                {"currencyCodeA": 826, "currencyCodeB": 980, "date": 1704384229, "rateCross": 48.7786},
                {"currencyCodeA": 392, "currencyCodeB": 980, "date": 1704384013, "rateCross": 0.2711},
                {"currencyCodeA": 756, "currencyCodeB": 980, "date": 1704384226, "rateCross": 45.332},
                {"currencyCodeA": 156, "currencyCodeB": 980, "date": 1704384225, "rateCross": 5.3825},
                {"currencyCodeA": 784, "currencyCodeB": 980, "date": 1704384219, "rateCross": 10.468},
                {"currencyCodeA": 971, "currencyCodeB": 980, "date": 1703852583, "rateCross": 0.5417},
                {"currencyCodeA": 8, "currencyCodeB": 980, "date": 1704383805, "rateCross": 0.4078},
                {"currencyCodeA": 51, "currencyCodeB": 980, "date": 1704384020, "rateCross": 0.0952},
                {"currencyCodeA": 973, "currencyCodeB": 980, "date": 1704021461, "rateCross": 0.0462},
                {"currencyCodeA": 32, "currencyCodeB": 980, "date": 1704384166, "rateCross": 0.0473},
                {"currencyCodeA": 36, "currencyCodeB": 980, "date": 1704382870, "rateCross": 26.056},
                {"currencyCodeA": 944, "currencyCodeB": 980, "date": 1704384097, "rateCross": 22.6149},
                {"currencyCodeA": 50, "currencyCodeB": 980, "date": 1704384162, "rateCross": 0.3511},
                {"currencyCodeA": 975, "currencyCodeB": 980, "date": 1704384232, "rateCross": 21.5679},
                {"currencyCodeA": 48, "currencyCodeB": 980, "date": 1704378184, "rateCross": 101.8937},
                {"currencyCodeA": 108, "currencyCodeB": 980, "date": 1703366443, "rateCross": 0.0133},
                {"currencyCodeA": 96, "currencyCodeB": 980, "date": 1703817834, "rateCross": 29.0031},
                {"currencyCodeA": 68, "currencyCodeB": 980, "date": 1704322021, "rateCross": 5.6053},
                {"currencyCodeA": 986, "currencyCodeB": 980, "date": 1704383608, "rateCross": 7.8497},
                {"currencyCodeA": 72, "currencyCodeB": 980, "date": 1701937687, "rateCross": 2.734},
                {"currencyCodeA": 933, "currencyCodeB": 980, "date": 1704383630, "rateCross": 12.0404},
                {"currencyCodeA": 124, "currencyCodeB": 980, "date": 1704384232, "rateCross": 28.8735},
                {"currencyCodeA": 976, "currencyCodeB": 980, "date": 1692273994, "rateCross": 0.0154},
                {"currencyCodeA": 152, "currencyCodeB": 980, "date": 1704382123, "rateCross": 0.0437},
                {"currencyCodeA": 170, "currencyCodeB": 980, "date": 1704383672, "rateCross": 0.0098},
                {"currencyCodeA": 188, "currencyCodeB": 980, "date": 1704379581, "rateCross": 0.0741},
                {"currencyCodeA": 192, "currencyCodeB": 980, "date": 1687102850, "rateCross": 1.5599},
                {"currencyCodeA": 203, "currencyCodeB": 980, "date": 1704384222, "rateCross": 1.712},
                {"currencyCodeA": 262, "currencyCodeB": 980, "date": 1702921113, "rateCross": 0.2109},
                {"currencyCodeA": 208, "currencyCodeB": 980, "date": 1704384213, "rateCross": 5.6627},
                {"currencyCodeA": 12, "currencyCodeB": 980, "date": 1704384232, "rateCross": 0.286},
                {"currencyCodeA": 818, "currencyCodeB": 980, "date": 1704383954, "rateCross": 1.2474},
                {"currencyCodeA": 230, "currencyCodeB": 980, "date": 1704303406, "rateCross": 0.6879},
                {"currencyCodeA": 981, "currencyCodeB": 980, "date": 1704384130, "rateCross": 14.4473},
                {"currencyCodeA": 936, "currencyCodeB": 980, "date": 1704383704, "rateCross": 3.2238},
                {"currencyCodeA": 270, "currencyCodeB": 980, "date": 1704122360, "rateCross": 0.6068},
                {"currencyCodeA": 324, "currencyCodeB": 980, "date": 1703962028, "rateCross": 0.0045},
                {"currencyCodeA": 344, "currencyCodeB": 980, "date": 1704382781, "rateCross": 4.9275},
                {"currencyCodeA": 191, "currencyCodeB": 980, "date": 1680625280, "rateCross": 5.4258},
                {"currencyCodeA": 348, "currencyCodeB": 980, "date": 1704384217, "rateCross": 0.1107},
                {"currencyCodeA": 360, "currencyCodeB": 980, "date": 1704384183, "rateCross": 0.0024},
                {"currencyCodeA": 376, "currencyCodeB": 980, "date": 1704384235, "rateCross": 10.6176},
                {"currencyCodeA": 356, "currencyCodeB": 980, "date": 1704384091, "rateCross": 0.4618},
                {"currencyCodeA": 368, "currencyCodeB": 980, "date": 1704376320, "rateCross": 0.0293},
                {"currencyCodeA": 352, "currencyCodeB": 980, "date": 1704383925, "rateCross": 0.2787},
                {"currencyCodeA": 400, "currencyCodeB": 980, "date": 1704382955, "rateCross": 54.3428},
                {"currencyCodeA": 404, "currencyCodeB": 980, "date": 1704384230, "rateCross": 0.2454},
                {"currencyCodeA": 417, "currencyCodeB": 980, "date": 1704381922, "rateCross": 0.4316},
                {"currencyCodeA": 116, "currencyCodeB": 980, "date": 1704377976, "rateCross": 0.0094},
                {"currencyCodeA": 410, "currencyCodeB": 980, "date": 1704383155, "rateCross": 0.0294},
                {"currencyCodeA": 414, "currencyCodeB": 980, "date": 1704366687, "rateCross": 125.1189},
                {"currencyCodeA": 398, "currencyCodeB": 980, "date": 1704384070, "rateCross": 0.0842},
                {"currencyCodeA": 418, "currencyCodeB": 980, "date": 1704340939, "rateCross": 0.0018},
                {"currencyCodeA": 422, "currencyCodeB": 980, "date": 1703932212, "rateCross": 0.0004},
                {"currencyCodeA": 144, "currencyCodeB": 980, "date": 1704384061, "rateCross": 0.1192},
                {"currencyCodeA": 434, "currencyCodeB": 980, "date": 1674670757, "rateCross": 7.8783},
                {"currencyCodeA": 504, "currencyCodeB": 980, "date": 1704383495, "rateCross": 3.88},
                {"currencyCodeA": 498, "currencyCodeB": 980, "date": 1704384231, "rateCross": 2.2104},
                {"currencyCodeA": 969, "currencyCodeB": 980, "date": 1704289455, "rateCross": 0.0084},
                {"currencyCodeA": 807, "currencyCodeB": 980, "date": 1704382524, "rateCross": 0.6826},
                {"currencyCodeA": 496, "currencyCodeB": 980, "date": 1704241014, "rateCross": 0.0112},
                {"currencyCodeA": 480, "currencyCodeB": 980, "date": 1704383821, "rateCross": 0.8688},
                {"currencyCodeA": 454, "currencyCodeB": 980, "date": 1678369785, "rateCross": 0.0368},
                {"currencyCodeA": 484, "currencyCodeB": 980, "date": 1704384042, "rateCross": 2.2619},
                {"currencyCodeA": 458, "currencyCodeB": 980, "date": 1704383550, "rateCross": 8.3269},
                {"currencyCodeA": 943, "currencyCodeB": 980, "date": 1704151037, "rateCross": 0.5988},
                {"currencyCodeA": 516, "currencyCodeB": 980, "date": 1704360042, "rateCross": 2.0801},
                {"currencyCodeA": 566, "currencyCodeB": 980, "date": 1704384081, "rateCross": 0.0431},
                {"currencyCodeA": 558, "currencyCodeB": 980, "date": 1704327971, "rateCross": 1.0498},
                {"currencyCodeA": 578, "currencyCodeB": 980, "date": 1704384225, "rateCross": 3.7512},
                {"currencyCodeA": 524, "currencyCodeB": 980, "date": 1704372322, "rateCross": 0.2883},
                {"currencyCodeA": 554, "currencyCodeB": 980, "date": 1704366903, "rateCross": 24.1352},
                {"currencyCodeA": 512, "currencyCodeB": 980, "date": 1704383096, "rateCross": 99.9394},
                {"currencyCodeA": 604, "currencyCodeB": 980, "date": 1704383158, "rateCross": 10.409},
                {"currencyCodeA": 608, "currencyCodeB": 980, "date": 1704383283, "rateCross": 0.6919},
                {"currencyCodeA": 586, "currencyCodeB": 980, "date": 1704384111, "rateCross": 0.1365},
                {"currencyCodeA": 985, "currencyCodeB": 980, "date": 1704384233, "rateCross": 9.6702},
                {"currencyCodeA": 600, "currencyCodeB": 980, "date": 1704383357, "rateCross": 0.0052},
                {"currencyCodeA": 634, "currencyCodeB": 980, "date": 1704383469, "rateCross": 10.5744},
                {"currencyCodeA": 946, "currencyCodeB": 980, "date": 1704384224, "rateCross": 8.4845},
                {"currencyCodeA": 941, "currencyCodeB": 980, "date": 1704384038, "rateCross": 0.3583},
                {"currencyCodeA": 682, "currencyCodeB": 980, "date": 1704384151, "rateCross": 10.2556},
                {"currencyCodeA": 690, "currencyCodeB": 980, "date": 1704379630, "rateCross": 2.7386},
                {"currencyCodeA": 938, "currencyCodeB": 980, "date": 1680961561, "rateCross": 0.0627},
                {"currencyCodeA": 752, "currencyCodeB": 980, "date": 1704384224, "rateCross": 3.7782},
                {"currencyCodeA": 702, "currencyCodeB": 980, "date": 1704383833, "rateCross": 29.0185},
                {"currencyCodeA": 694, "currencyCodeB": 980, "date": 1664217991, "rateCross": 0.0024},
                {"currencyCodeA": 706, "currencyCodeB": 980, "date": 1683386099, "rateCross": 0.0659},
                {"currencyCodeA": 968, "currencyCodeB": 980, "date": 1696117310, "rateCross": 0.9686},
                {"currencyCodeA": 748, "currencyCodeB": 980, "date": 1703073963, "rateCross": 2.0623},
                {"currencyCodeA": 764, "currencyCodeB": 980, "date": 1704384151, "rateCross": 1.1248},
                {"currencyCodeA": 972, "currencyCodeB": 980, "date": 1704378612, "rateCross": 3.5073},
                {"currencyCodeA": 788, "currencyCodeB": 980, "date": 1704378497, "rateCross": 12.4833},
                {"currencyCodeA": 949, "currencyCodeB": 980, "date": 1704384224, "rateCross": 1.3023},
                {"currencyCodeA": 901, "currencyCodeB": 980, "date": 1704381444, "rateCross": 1.2396},
                {"currencyCodeA": 834, "currencyCodeB": 980, "date": 1704383156, "rateCross": 0.0153},
                {"currencyCodeA": 800, "currencyCodeB": 980, "date": 1704384092, "rateCross": 0.0101},
                {"currencyCodeA": 858, "currencyCodeB": 980, "date": 1704378388, "rateCross": 0.9836},
                {"currencyCodeA": 860, "currencyCodeB": 980, "date": 1704383812, "rateCross": 0.0031},
                {"currencyCodeA": 704, "currencyCodeB": 980, "date": 1704384051, "rateCross": 0.0015},
                {"currencyCodeA": 950, "currencyCodeB": 980, "date": 1704378702, "rateCross": 0.0642},
                {"currencyCodeA": 952, "currencyCodeB": 980, "date": 1704330607, "rateCross": 0.0642},
                {"currencyCodeA": 886, "currencyCodeB": 980, "date": 1702176265, "rateCross": 0.1496},
                {"currencyCodeA": 710, "currencyCodeB": 980, "date": 1704384232, "rateCross": 2.0806}]
        nbu = [{"r030": 36, "txt": "Австралійський долар", "rate": 25.5827, "cc": "AUD", "exchangedate": "05.01.2024"},
               {"r030": 124, "txt": "Канадський долар", "rate": 28.5295, "cc": "CAD", "exchangedate": "05.01.2024"},
               {"r030": 156, "txt": "Юань Женьміньбі", "rate": 5.3196, "cc": "CNY", "exchangedate": "05.01.2024"},
               {"r030": 203, "txt": "Чеська крона", "rate": 1.6902, "cc": "CZK", "exchangedate": "05.01.2024"},
               {"r030": 208, "txt": "Данська крона", "rate": 5.5862, "cc": "DKK", "exchangedate": "05.01.2024"},
               {"r030": 344, "txt": "Гонконгівський долар", "rate": 4.8721, "cc": "HKD", "exchangedate": "05.01.2024"},
               {"r030": 348, "txt": "Форинт", "rate": 0.110025, "cc": "HUF", "exchangedate": "05.01.2024"},
               {"r030": 356, "txt": "Індійська рупія", "rate": 0.45706, "cc": "INR", "exchangedate": "05.01.2024"},
               {"r030": 360, "txt": "Рупія", "rate": 0.0024541, "cc": "IDR", "exchangedate": "05.01.2024"},
               {"r030": 376, "txt": "Новий ізраїльський шекель", "rate": 10.4265, "cc": "ILS",
                "exchangedate": "05.01.2024"},
               {"r030": 392, "txt": "Єна", "rate": 0.26379, "cc": "JPY", "exchangedate": "05.01.2024"},
               {"r030": 398, "txt": "Теньге", "rate": 0.083657, "cc": "KZT", "exchangedate": "05.01.2024"},
               {"r030": 410, "txt": "Вона", "rate": 0.029028, "cc": "KRW", "exchangedate": "05.01.2024"},
               {"r030": 484, "txt": "Мексиканське песо", "rate": 2.2382, "cc": "MXN", "exchangedate": "05.01.2024"},
               {"r030": 498, "txt": "Молдовський лей", "rate": 2.1653, "cc": "MDL", "exchangedate": "05.01.2024"},
               {"r030": 554, "txt": "Новозеландський долар", "rate": 23.7643, "cc": "NZD",
                "exchangedate": "05.01.2024"},
               {"r030": 578, "txt": "Норвезька крона", "rate": 3.6963, "cc": "NOK", "exchangedate": "05.01.2024"},
               {"r030": 643, "txt": "Російський рубль", "rate": 0.41696, "cc": "RUB", "exchangedate": "05.01.2024"},
               {"r030": 702, "txt": "Сінгапурський долар", "rate": 28.6455, "cc": "SGD", "exchangedate": "05.01.2024"},
               {"r030": 710, "txt": "Ренд", "rate": 2.0389, "cc": "ZAR", "exchangedate": "05.01.2024"},
               {"r030": 752, "txt": "Шведська крона", "rate": 3.7246, "cc": "SEK", "exchangedate": "05.01.2024"},
               {"r030": 756, "txt": "Швейцарський франк", "rate": 44.7517, "cc": "CHF", "exchangedate": "05.01.2024"},
               {"r030": 818, "txt": "Єгипетський фунт", "rate": 1.2314, "cc": "EGP", "exchangedate": "05.01.2024"},
               {"r030": 826, "txt": "Фунт стерлінгів", "rate": 48.2876, "cc": "GBP", "exchangedate": "05.01.2024"},
               {"r030": 840, "txt": "Долар США", "rate": 38.0412, "cc": "USD", "exchangedate": "05.01.2024"},
               {"r030": 933, "txt": "Білоруський рубль", "rate": 13.8271, "cc": "BYN", "exchangedate": "05.01.2024"},
               {"r030": 944, "txt": "Азербайджанський манат", "rate": 22.3903, "cc": "AZN",
                "exchangedate": "05.01.2024"},
               {"r030": 946, "txt": "Румунський лей", "rate": 8.378, "cc": "RON", "exchangedate": "05.01.2024"},
               {"r030": 949, "txt": "Турецька ліра", "rate": 1.2775, "cc": "TRY", "exchangedate": "05.01.2024"},
               {"r030": 960, "txt": "СПЗ (спеціальні права запозичення)", "rate": 50.8687, "cc": "XDR",
                "exchangedate": "05.01.2024"},
               {"r030": 975, "txt": "Болгарський лев", "rate": 21.3092, "cc": "BGN", "exchangedate": "05.01.2024"},
               {"r030": 978, "txt": "Євро", "rate": 41.6665, "cc": "EUR", "exchangedate": "05.01.2024"},
               {"r030": 985, "txt": "Злотий", "rate": 9.5872, "cc": "PLN", "exchangedate": "05.01.2024"},
               {"r030": 12, "txt": "Алжирський динар", "rate": 0.2833, "cc": "DZD", "exchangedate": "05.01.2024"},
               {"r030": 50, "txt": "Така", "rate": 0.34547, "cc": "BDT", "exchangedate": "05.01.2024"},
               {"r030": 51, "txt": "Вірменський драм", "rate": 0.093881, "cc": "AMD", "exchangedate": "05.01.2024"},
               {"r030": 214, "txt": "Домініканське песо", "rate": 0.6563, "cc": "DOP", "exchangedate": "05.01.2024"},
               {"r030": 364, "txt": "Іранський ріал", "rate": 0.00090481, "cc": "IRR", "exchangedate": "05.01.2024"},
               {"r030": 368, "txt": "Іракський динар", "rate": 0.029009, "cc": "IQD", "exchangedate": "05.01.2024"},
               {"r030": 417, "txt": "Сом", "rate": 0.42658, "cc": "KGS", "exchangedate": "05.01.2024"},
               {"r030": 422, "txt": "Ліванський фунт", "rate": 0.002533, "cc": "LBP", "exchangedate": "05.01.2024"},
               {"r030": 434, "txt": "Лівійський динар", "rate": 7.9744, "cc": "LYD", "exchangedate": "05.01.2024"},
               {"r030": 458, "txt": "Малайзійський ринггіт", "rate": 8.2708, "cc": "MYR", "exchangedate": "05.01.2024"},
               {"r030": 504, "txt": "Марокканський дирхам", "rate": 3.8487, "cc": "MAD", "exchangedate": "05.01.2024"},
               {"r030": 586, "txt": "Пакистанська рупія", "rate": 0.13479, "cc": "PKR", "exchangedate": "05.01.2024"},
               {"r030": 682, "txt": "Саудівський ріял", "rate": 10.1336, "cc": "SAR", "exchangedate": "05.01.2024"},
               {"r030": 704, "txt": "Донг", "rate": 0.0015659, "cc": "VND", "exchangedate": "05.01.2024"},
               {"r030": 764, "txt": "Бат", "rate": 1.10648, "cc": "THB", "exchangedate": "05.01.2024"},
               {"r030": 784, "txt": "Дирхам ОАЕ", "rate": 10.3469, "cc": "AED", "exchangedate": "05.01.2024"},
               {"r030": 788, "txt": "Туніський динар", "rate": 12.3737, "cc": "TND", "exchangedate": "05.01.2024"},
               {"r030": 860, "txt": "Узбецький сум", "rate": 0.0030675, "cc": "UZS", "exchangedate": "05.01.2024"},
               {"r030": 901, "txt": "Новий тайванський долар", "rate": 1.2425, "cc": "TWD",
                "exchangedate": "05.01.2024"},
               {"r030": 934, "txt": "Туркменський новий манат", "rate": 10.8577, "cc": "TMT",
                "exchangedate": "05.01.2024"},
               {"r030": 941, "txt": "Сербський динар", "rate": 0.35828, "cc": "RSD", "exchangedate": "05.01.2024"},
               {"r030": 972, "txt": "Сомоні", "rate": 3.469, "cc": "TJS", "exchangedate": "05.01.2024"},
               {"r030": 981, "txt": "Ларі", "rate": 14.1403, "cc": "GEL", "exchangedate": "05.01.2024"},
               {"r030": 986, "txt": "Бразильський реал", "rate": 7.8314, "cc": "BRL", "exchangedate": "05.01.2024"},
               {"r030": 959, "txt": "Золото", "rate": 77825.83, "cc": "XAU", "exchangedate": "05.01.2024"},
               {"r030": 961, "txt": "Срібло", "rate": 874.23, "cc": "XAG", "exchangedate": "05.01.2024"},
               {"r030": 962, "txt": "Платина", "rate": 37073.43, "cc": "XPT", "exchangedate": "05.01.2024"},
               {"r030": 964, "txt": "Паладій", "rate": 40698.76, "cc": "XPD", "exchangedate": "05.01.2024"}]
        return {NATIONAL_BANK: nbu, MONO_BANK: mono, PRIVAT_BANK: privat}

    def get_requested_currency(self):
        currency_options = CurrencyOption(USD=True, EUR=False, PLN=False, GBP=False, TRY=False, CHF=False)
        return currency_options.get_requested_currency()

    async def test_currency_logic(self):
        valid_data = CurrencyTransformation(data_source=self.get_data_source(),
                                            requested_currency=self.get_requested_currency())

        on_time = str(datetime.today().strftime("%d.%m.%Y %H:%M"))

        expected_result = {
            NATIONAL_BANK: {
                "USD": {
                    "currency_code": "USD",
                    "base_currency_code": "UAH",
                    "buy_rate": 0.0,
                    "cross_rate": 38.0412,
                    "sale_rate": 0.0,
                    "on_time": on_time
                }
            },
            PRIVAT_BANK: {
                "USD": {
                    "currency_code": "USD",
                    "base_currency_code": "UAH",
                    "buy_rate": 37.65,
                    "cross_rate": 0,
                    "sale_rate": 38.46154,
                    "on_time": on_time
                }
            },
            MONO_BANK: {
                "USD": {
                    "currency_code": "USD",
                    "base_currency_code": "UAH",
                    "buy_rate": 38,
                    "cross_rate": 0,
                    "sale_rate": 38.4497,
                    "on_time": on_time
                }
            }
        }

        assert valid_data.currency == expected_result


class TestLogicInvalidData:
    def get_data_source(self):
        privat = [{"currency": "EUR", "base_currency": "UAH", "buy_rate": "41.15000", "sale_rate": "42.19409"},
                  {"currency": "USD", "base_currency": "UAH", "buy_rate": "37.65000", "sale_rate": "38.46154"}]
        mono = [{"currencyCodeA": 840, "currencyCodeB": 980, "date": 1704383173, "rateBuy": 38, "rateSell": 38.4497},
                {"currencyCodeA": 978, "currencyCodeB": 980, "date": 1704383173, "rateBuy": 41.5, "rateSell": 42.1496},
                {"currencyCodeA": 978, "currencyCodeB": 840, "date": 1704383173, "rateBuy": 1.088, "rateSell": 1.1},
                {"currencyCodeA": 826, "currencyCodeB": 980, "date": 1704384229, "rateCross": 48.7786},
                {"currencyCodeA": 392, "currencyCodeB": 980, "date": 1704384013, "rateCross": 0.2711},
                {"currencyCodeA": 756, "currencyCodeB": 980, "date": 1704384226, "rateCross": 45.332},
                {"currencyCodeA": 156, "currencyCodeB": 980, "date": 1704384225, "rateCross": 5.3825},
                {"currencyCodeA": 784, "currencyCodeB": 980, "date": 1704384219, "rateCross": 10.468},
                {"currencyCodeA": 971, "currencyCodeB": 980, "date": 1703852583, "rateCross": 0.5417},
                {"currencyCodeA": 8, "currencyCodeB": 980, "date": 1704383805, "rateCross": 0.4078},
                {"currencyCodeA": 51, "currencyCodeB": 980, "date": 1704384020, "rateCross": 0.0952},
                {"currencyCodeA": 973, "currencyCodeB": 980, "date": 1704021461, "rateCross": 0.0462},
                {"currencyCodeA": 32, "currencyCodeB": 980, "date": 1704384166, "rateCross": 0.0473},
                {"currencyCodeA": 36, "currencyCodeB": 980, "date": 1704382870, "rateCross": 26.056},
                {"currencyCodeA": 944, "currencyCodeB": 980, "date": 1704384097, "rateCross": 22.6149},
                {"currencyCodeA": 50, "currencyCodeB": 980, "date": 1704384162, "rateCross": 0.3511},
                {"currencyCodeA": 975, "currencyCodeB": 980, "date": 1704384232, "rateCross": 21.5679},
                {"currencyCodeA": 48, "currencyCodeB": 980, "date": 1704378184, "rateCross": 101.8937},
                {"currencyCodeA": 108, "currencyCodeB": 980, "date": 1703366443, "rateCross": 0.0133},
                {"currencyCodeA": 96, "currencyCodeB": 980, "date": 1703817834, "rateCross": 29.0031},
                {"currencyCodeA": 68, "currencyCodeB": 980, "date": 1704322021, "rateCross": 5.6053},
                {"currencyCodeA": 986, "currencyCodeB": 980, "date": 1704383608, "rateCross": 7.8497},
                {"currencyCodeA": 72, "currencyCodeB": 980, "date": 1701937687, "rateCross": 2.734},
                {"currencyCodeA": 933, "currencyCodeB": 980, "date": 1704383630, "rateCross": 12.0404},
                {"currencyCodeA": 124, "currencyCodeB": 980, "date": 1704384232, "rateCross": 28.8735},
                {"currencyCodeA": 976, "currencyCodeB": 980, "date": 1692273994, "rateCross": 0.0154},
                {"currencyCodeA": 152, "currencyCodeB": 980, "date": 1704382123, "rateCross": 0.0437},
                {"currencyCodeA": 170, "currencyCodeB": 980, "date": 1704383672, "rateCross": 0.0098},
                {"currencyCodeA": 188, "currencyCodeB": 980, "date": 1704379581, "rateCross": 0.0741},
                {"currencyCodeA": 192, "currencyCodeB": 980, "date": 1687102850, "rateCross": 1.5599},
                {"currencyCodeA": 203, "currencyCodeB": 980, "date": 1704384222, "rateCross": 1.712},
                {"currencyCodeA": 262, "currencyCodeB": 980, "date": 1702921113, "rateCross": 0.2109},
                {"currencyCodeA": 208, "currencyCodeB": 980, "date": 1704384213, "rateCross": 5.6627},
                {"currencyCodeA": 12, "currencyCodeB": 980, "date": 1704384232, "rateCross": 0.286},
                {"currencyCodeA": 818, "currencyCodeB": 980, "date": 1704383954, "rateCross": 1.2474},
                {"currencyCodeA": 230, "currencyCodeB": 980, "date": 1704303406, "rateCross": 0.6879},
                {"currencyCodeA": 981, "currencyCodeB": 980, "date": 1704384130, "rateCross": 14.4473},
                {"currencyCodeA": 936, "currencyCodeB": 980, "date": 1704383704, "rateCross": 3.2238},
                {"currencyCodeA": 270, "currencyCodeB": 980, "date": 1704122360, "rateCross": 0.6068},
                {"currencyCodeA": 324, "currencyCodeB": 980, "date": 1703962028, "rateCross": 0.0045},
                {"currencyCodeA": 344, "currencyCodeB": 980, "date": 1704382781, "rateCross": 4.9275},
                {"currencyCodeA": 191, "currencyCodeB": 980, "date": 1680625280, "rateCross": 5.4258},
                {"currencyCodeA": 348, "currencyCodeB": 980, "date": 1704384217, "rateCross": 0.1107},
                {"currencyCodeA": 360, "currencyCodeB": 980, "date": 1704384183, "rateCross": 0.0024},
                {"currencyCodeA": 376, "currencyCodeB": 980, "date": 1704384235, "rateCross": 10.6176},
                {"currencyCodeA": 356, "currencyCodeB": 980, "date": 1704384091, "rateCross": 0.4618},
                {"currencyCodeA": 368, "currencyCodeB": 980, "date": 1704376320, "rateCross": 0.0293},
                {"currencyCodeA": 352, "currencyCodeB": 980, "date": 1704383925, "rateCross": 0.2787},
                {"currencyCodeA": 400, "currencyCodeB": 980, "date": 1704382955, "rateCross": 54.3428},
                {"currencyCodeA": 404, "currencyCodeB": 980, "date": 1704384230, "rateCross": 0.2454},
                {"currencyCodeA": 417, "currencyCodeB": 980, "date": 1704381922, "rateCross": 0.4316},
                {"currencyCodeA": 116, "currencyCodeB": 980, "date": 1704377976, "rateCross": 0.0094},
                {"currencyCodeA": 410, "currencyCodeB": 980, "date": 1704383155, "rateCross": 0.0294},
                {"currencyCodeA": 414, "currencyCodeB": 980, "date": 1704366687, "rateCross": 125.1189},
                {"currencyCodeA": 398, "currencyCodeB": 980, "date": 1704384070, "rateCross": 0.0842},
                {"currencyCodeA": 418, "currencyCodeB": 980, "date": 1704340939, "rateCross": 0.0018},
                {"currencyCodeA": 422, "currencyCodeB": 980, "date": 1703932212, "rateCross": 0.0004},
                {"currencyCodeA": 144, "currencyCodeB": 980, "date": 1704384061, "rateCross": 0.1192},
                {"currencyCodeA": 434, "currencyCodeB": 980, "date": 1674670757, "rateCross": 7.8783},
                {"currencyCodeA": 504, "currencyCodeB": 980, "date": 1704383495, "rateCross": 3.88},
                {"currencyCodeA": 498, "currencyCodeB": 980, "date": 1704384231, "rateCross": 2.2104},
                {"currencyCodeA": 969, "currencyCodeB": 980, "date": 1704289455, "rateCross": 0.0084},
                {"currencyCodeA": 807, "currencyCodeB": 980, "date": 1704382524, "rateCross": 0.6826},
                {"currencyCodeA": 496, "currencyCodeB": 980, "date": 1704241014, "rateCross": 0.0112},
                {"currencyCodeA": 480, "currencyCodeB": 980, "date": 1704383821, "rateCross": 0.8688},
                {"currencyCodeA": 454, "currencyCodeB": 980, "date": 1678369785, "rateCross": 0.0368},
                {"currencyCodeA": 484, "currencyCodeB": 980, "date": 1704384042, "rateCross": 2.2619},
                {"currencyCodeA": 458, "currencyCodeB": 980, "date": 1704383550, "rateCross": 8.3269},
                {"currencyCodeA": 943, "currencyCodeB": 980, "date": 1704151037, "rateCross": 0.5988},
                {"currencyCodeA": 516, "currencyCodeB": 980, "date": 1704360042, "rateCross": 2.0801},
                {"currencyCodeA": 566, "currencyCodeB": 980, "date": 1704384081, "rateCross": 0.0431},
                {"currencyCodeA": 558, "currencyCodeB": 980, "date": 1704327971, "rateCross": 1.0498},
                {"currencyCodeA": 578, "currencyCodeB": 980, "date": 1704384225, "rateCross": 3.7512},
                {"currencyCodeA": 524, "currencyCodeB": 980, "date": 1704372322, "rateCross": 0.2883},
                {"currencyCodeA": 554, "currencyCodeB": 980, "date": 1704366903, "rateCross": 24.1352},
                {"currencyCodeA": 512, "currencyCodeB": 980, "date": 1704383096, "rateCross": 99.9394},
                {"currencyCodeA": 604, "currencyCodeB": 980, "date": 1704383158, "rateCross": 10.409},
                {"currencyCodeA": 608, "currencyCodeB": 980, "date": 1704383283, "rateCross": 0.6919},
                {"currencyCodeA": 586, "currencyCodeB": 980, "date": 1704384111, "rateCross": 0.1365},
                {"currencyCodeA": 985, "currencyCodeB": 980, "date": 1704384233, "rateCross": 9.6702},
                {"currencyCodeA": 600, "currencyCodeB": 980, "date": 1704383357, "rateCross": 0.0052},
                {"currencyCodeA": 634, "currencyCodeB": 980, "date": 1704383469, "rateCross": 10.5744},
                {"currencyCodeA": 946, "currencyCodeB": 980, "date": 1704384224, "rateCross": 8.4845},
                {"currencyCodeA": 941, "currencyCodeB": 980, "date": 1704384038, "rateCross": 0.3583},
                {"currencyCodeA": 682, "currencyCodeB": 980, "date": 1704384151, "rateCross": 10.2556},
                {"currencyCodeA": 690, "currencyCodeB": 980, "date": 1704379630, "rateCross": 2.7386},
                {"currencyCodeA": 938, "currencyCodeB": 980, "date": 1680961561, "rateCross": 0.0627},
                {"currencyCodeA": 752, "currencyCodeB": 980, "date": 1704384224, "rateCross": 3.7782},
                {"currencyCodeA": 702, "currencyCodeB": 980, "date": 1704383833, "rateCross": 29.0185},
                {"currencyCodeA": 694, "currencyCodeB": 980, "date": 1664217991, "rateCross": 0.0024},
                {"currencyCodeA": 706, "currencyCodeB": 980, "date": 1683386099, "rateCross": 0.0659},
                {"currencyCodeA": 968, "currencyCodeB": 980, "date": 1696117310, "rateCross": 0.9686},
                {"currencyCodeA": 748, "currencyCodeB": 980, "date": 1703073963, "rateCross": 2.0623},
                {"currencyCodeA": 764, "currencyCodeB": 980, "date": 1704384151, "rateCross": 1.1248},
                {"currencyCodeA": 972, "currencyCodeB": 980, "date": 1704378612, "rateCross": 3.5073},
                {"currencyCodeA": 788, "currencyCodeB": 980, "date": 1704378497, "rateCross": 12.4833},
                {"currencyCodeA": 949, "currencyCodeB": 980, "date": 1704384224, "rateCross": 1.3023},
                {"currencyCodeA": 901, "currencyCodeB": 980, "date": 1704381444, "rateCross": 1.2396},
                {"currencyCodeA": 834, "currencyCodeB": 980, "date": 1704383156, "rateCross": 0.0153},
                {"currencyCodeA": 800, "currencyCodeB": 980, "date": 1704384092, "rateCross": 0.0101},
                {"currencyCodeA": 858, "currencyCodeB": 980, "date": 1704378388, "rateCross": 0.9836},
                {"currencyCodeA": 860, "currencyCodeB": 980, "date": 1704383812, "rateCross": 0.0031},
                {"currencyCodeA": 704, "currencyCodeB": 980, "date": 1704384051, "rateCross": 0.0015},
                {"currencyCodeA": 950, "currencyCodeB": 980, "date": 1704378702, "rateCross": 0.0642},
                {"currencyCodeA": 952, "currencyCodeB": 980, "date": 1704330607, "rateCross": 0.0642},
                {"currencyCodeA": 886, "currencyCodeB": 980, "date": 1702176265, "rateCross": 0.1496},
                {"currencyCodeA": 710, "currencyCodeB": 980, "date": 1704384232, "rateCross": 2.0806}]
        nbu = [{"r030": 36, "txt": "Австралійський долар", "rate": 25.5827, "cc": "AUD", "exchangedate": "05.01.2024"},
               {"r030": 124, "txt": "Канадський долар", "rate": 28.5295, "cc": "CAD", "exchangedate": "05.01.2024"},
               {"r030": 156, "txt": "Юань Женьміньбі", "rate": 5.3196, "cc": "CNY", "exchangedate": "05.01.2024"},
               {"r030": 203, "txt": "Чеська крона", "rate": 1.6902, "cc": "CZK", "exchangedate": "05.01.2024"},
               {"r030": 208, "txt": "Данська крона", "rate": 5.5862, "cc": "DKK", "exchangedate": "05.01.2024"},
               {"r030": 344, "txt": "Гонконгівський долар", "rate": 4.8721, "cc": "HKD", "exchangedate": "05.01.2024"},
               {"r030": 348, "txt": "Форинт", "rate": 0.110025, "cc": "HUF", "exchangedate": "05.01.2024"},
               {"r030": 356, "txt": "Індійська рупія", "rate": 0.45706, "cc": "INR", "exchangedate": "05.01.2024"},
               {"r030": 360, "txt": "Рупія", "rate": 0.0024541, "cc": "IDR", "exchangedate": "05.01.2024"},
               {"r030": 376, "txt": "Новий ізраїльський шекель", "rate": 10.4265, "cc": "ILS",
                "exchangedate": "05.01.2024"},
               {"r030": 392, "txt": "Єна", "rate": 0.26379, "cc": "JPY", "exchangedate": "05.01.2024"},
               {"r030": 398, "txt": "Теньге", "rate": 0.083657, "cc": "KZT", "exchangedate": "05.01.2024"},
               {"r030": 410, "txt": "Вона", "rate": 0.029028, "cc": "KRW", "exchangedate": "05.01.2024"},
               {"r030": 484, "txt": "Мексиканське песо", "rate": 2.2382, "cc": "MXN", "exchangedate": "05.01.2024"},
               {"r030": 498, "txt": "Молдовський лей", "rate": 2.1653, "cc": "MDL", "exchangedate": "05.01.2024"},
               {"r030": 554, "txt": "Новозеландський долар", "rate": 23.7643, "cc": "NZD",
                "exchangedate": "05.01.2024"},
               {"r030": 578, "txt": "Норвезька крона", "rate": 3.6963, "cc": "NOK", "exchangedate": "05.01.2024"},
               {"r030": 643, "txt": "Російський рубль", "rate": 0.41696, "cc": "RUB", "exchangedate": "05.01.2024"},
               {"r030": 702, "txt": "Сінгапурський долар", "rate": 28.6455, "cc": "SGD", "exchangedate": "05.01.2024"},
               {"r030": 710, "txt": "Ренд", "rate": 2.0389, "cc": "ZAR", "exchangedate": "05.01.2024"},
               {"r030": 752, "txt": "Шведська крона", "rate": 3.7246, "cc": "SEK", "exchangedate": "05.01.2024"},
               {"r030": 756, "txt": "Швейцарський франк", "rate": 44.7517, "cc": "CHF", "exchangedate": "05.01.2024"},
               {"r030": 818, "txt": "Єгипетський фунт", "rate": 1.2314, "cc": "EGP", "exchangedate": "05.01.2024"},
               {"r030": 826, "txt": "Фунт стерлінгів", "rate": 48.2876, "cc": "GBP", "exchangedate": "05.01.2024"},
               {"r030": 840, "txt": "Долар США", "rate": 38.0412, "cc": "USD", "exchangedate": "05.01.2024"},
               {"r030": 933, "txt": "Білоруський рубль", "rate": 13.8271, "cc": "BYN", "exchangedate": "05.01.2024"},
               {"r030": 944, "txt": "Азербайджанський манат", "rate": 22.3903, "cc": "AZN",
                "exchangedate": "05.01.2024"},
               {"r030": 946, "txt": "Румунський лей", "rate": 8.378, "cc": "RON", "exchangedate": "05.01.2024"},
               {"r030": 949, "txt": "Турецька ліра", "rate": 1.2775, "cc": "TRY", "exchangedate": "05.01.2024"},
               {"r030": 960, "txt": "СПЗ (спеціальні права запозичення)", "rate": 50.8687, "cc": "XDR",
                "exchangedate": "05.01.2024"},
               {"r030": 975, "txt": "Болгарський лев", "rate": 21.3092, "cc": "BGN", "exchangedate": "05.01.2024"},
               {"r030": 978, "txt": "Євро", "rate": 41.6665, "cc": "EUR", "exchangedate": "05.01.2024"},
               {"r030": 985, "txt": "Злотий", "rate": 9.5872, "cc": "PLN", "exchangedate": "05.01.2024"},
               {"r030": 12, "txt": "Алжирський динар", "rate": 0.2833, "cc": "DZD", "exchangedate": "05.01.2024"},
               {"r030": 50, "txt": "Така", "rate": 0.34547, "cc": "BDT", "exchangedate": "05.01.2024"},
               {"r030": 51, "txt": "Вірменський драм", "rate": 0.093881, "cc": "AMD", "exchangedate": "05.01.2024"},
               {"r030": 214, "txt": "Домініканське песо", "rate": 0.6563, "cc": "DOP", "exchangedate": "05.01.2024"},
               {"r030": 364, "txt": "Іранський ріал", "rate": 0.00090481, "cc": "IRR", "exchangedate": "05.01.2024"},
               {"r030": 368, "txt": "Іракський динар", "rate": 0.029009, "cc": "IQD", "exchangedate": "05.01.2024"},
               {"r030": 417, "txt": "Сом", "rate": 0.42658, "cc": "KGS", "exchangedate": "05.01.2024"},
               {"r030": 422, "txt": "Ліванський фунт", "rate": 0.002533, "cc": "LBP", "exchangedate": "05.01.2024"},
               {"r030": 434, "txt": "Лівійський динар", "rate": 7.9744, "cc": "LYD", "exchangedate": "05.01.2024"},
               {"r030": 458, "txt": "Малайзійський ринггіт", "rate": 8.2708, "cc": "MYR", "exchangedate": "05.01.2024"},
               {"r030": 504, "txt": "Марокканський дирхам", "rate": 3.8487, "cc": "MAD", "exchangedate": "05.01.2024"},
               {"r030": 586, "txt": "Пакистанська рупія", "rate": 0.13479, "cc": "PKR", "exchangedate": "05.01.2024"},
               {"r030": 682, "txt": "Саудівський ріял", "rate": 10.1336, "cc": "SAR", "exchangedate": "05.01.2024"},
               {"r030": 704, "txt": "Донг", "rate": 0.0015659, "cc": "VND", "exchangedate": "05.01.2024"},
               {"r030": 764, "txt": "Бат", "rate": 1.10648, "cc": "THB", "exchangedate": "05.01.2024"},
               {"r030": 784, "txt": "Дирхам ОАЕ", "rate": 10.3469, "cc": "AED", "exchangedate": "05.01.2024"},
               {"r030": 788, "txt": "Туніський динар", "rate": 12.3737, "cc": "TND", "exchangedate": "05.01.2024"},
               {"r030": 860, "txt": "Узбецький сум", "rate": 0.0030675, "cc": "UZS", "exchangedate": "05.01.2024"},
               {"r030": 901, "txt": "Новий тайванський долар", "rate": 1.2425, "cc": "TWD",
                "exchangedate": "05.01.2024"},
               {"r030": 934, "txt": "Туркменський новий манат", "rate": 10.8577, "cc": "TMT",
                "exchangedate": "05.01.2024"},
               {"r030": 941, "txt": "Сербський динар", "rate": 0.35828, "cc": "RSD", "exchangedate": "05.01.2024"},
               {"r030": 972, "txt": "Сомоні", "rate": 3.469, "cc": "TJS", "exchangedate": "05.01.2024"},
               {"r030": 981, "txt": "Ларі", "rate": 14.1403, "cc": "GEL", "exchangedate": "05.01.2024"},
               {"r030": 986, "txt": "Бразильський реал", "rate": 7.8314, "cc": "BRL", "exchangedate": "05.01.2024"},
               {"r030": 959, "txt": "Золото", "rate": 77825.83, "cc": "XAU", "exchangedate": "05.01.2024"},
               {"r030": 961, "txt": "Срібло", "rate": 874.23, "cc": "XAG", "exchangedate": "05.01.2024"},
               {"r030": 962, "txt": "Платина", "rate": 37073.43, "cc": "XPT", "exchangedate": "05.01.2024"},
               {"r030": 964, "txt": "Паладій", "rate": 40698.76, "cc": "XPD", "exchangedate": "05.01.2024"}]
        return {NATIONAL_BANK: nbu, MONO_BANK: mono, PRIVAT_BANK: privat}

    def get_requested_currency(self):
        currency_options = CurrencyOption(USD=True, EUR=False, PLN=False, GBP=False, TRY=False, CHF=False)
        return currency_options.get_requested_currency()

    async def test_currency_logic(self):
        with pytest.raises(ValidationDataError):
            valid_data = CurrencyTransformation(data_source=self.get_data_source(),
                                                requested_currency=self.get_requested_currency())

            on_time = str(datetime.today().strftime("%d.%m.%Y %H:%M"))



